#!/usr/bin/env python
# -*- coding:utf-8 -*-
from datetime import date, timedelta
import celue4
import os


url_list = ['20210331', '20210330', '20210329', '20210328', '20210327', '20210326', '20210325', '20210324', '20210323', '20210322', '20210321', '20210320', '20210319', '20210318', '20210317', '20210316', '20210315', '20210314', '20210313', '20210312', '20210311', '20210310', '20210309', '20210308', '20210307', '20210306', '20210305', '20210304', '20210303', '20210302', '20210301', '20210228', '20210227', '20210226', '20210225', '20210224', '20210223', '20210222', '20210221', '20210220', '20210219', '20210218', '20210217', '20210216', '20210215', '20210214', '20210213', '20210212', '20210211', '20210210', '20210209', '20210208', '20210207', '20210206', '20210205', '20210204', '20210203', '20210202', '20210201', '20210131', '20210130', '20210129', '20210128', '20210127', '20210126', '20210125', '20210124', '20210123', '20210122', '20210121', '20210120', '20210119', '20210118', '20210117', '20210116', '20210115', '20210114', '20210113', '20210112', '20210111', '20210110', '20210109', '20210108', '20210107', '20210106', '20210105', '20210104', '20210103', '20210102', '20210101', '20201231', '20201230', '20201229', '20201228', '20201227', '20201226', '20201225', '20201224', '20201223', '20201222', '20201221', '20201220', '20201219', '20201218', '20201217', '20201216', '20201215', '20201214', '20201213', '20201212', '20201211', '20201210', '20201209', '20201208', '20201207', '20201206', '20201205', '20201204', '20201203', '20201202', '20201201', '20201130', '20201129', '20201128', '20201127', '20201126', '20201125', '20201124', '20201123', '20201122', '20201121', '20201120', '20201119', '20201118', '20201117', '20201116', '20201115', '20201114', '20201113', '20201112', '20201111', '20201110', '20201109', '20201108', '20201107', '20201106', '20201105', '20201104', '20201103', '20201102', '20201101', '20201031', '20201030', '20201029', '20201028', '20201027', '20201026', '20201025', '20201024', '20201023', '20201022', '20201021', '20201020', '20201019', '20201018', '20201017', '20201016', '20201015', '20201014', '20201013', '20201012', '20201011', '20201010', '20201009', '20201008', '20201007', '20201006', '20201005', '20201004', '20201003', '20201002', '20201001', '20200930', '20200929', '20200928', '20200927', '20200926', '20200925', '20200924', '20200923', '20200922', '20200921', '20200920', '20200919', '20200918', '20200917', '20200916', '20200915', '20200914', '20200913', '20200912', '20200911', '20200910', '20200909', '20200908', '20200907', '20200906', '20200905', '20200904', '20200903', '20200902', '20200901', '20200831', '20200830', '20200829', '20200828', '20200827', '20200826', '20200825', '20200824', '20200823', '20200822', '20200821', '20200820', '20200819', '20200818', '20200817', '20200816', '20200815', '20200814', '20200813', '20200812', '20200811', '20200810', '20200809', '20200808', '20200807', '20200806', '20200805', '20200804', '20200803', '20200802', '20200801', '20200731', '20200730', '20200729', '20200728', '20200727', '20200726', '20200725', '20200724', '20200723', '20200722', '20200721', '20200720', '20200719', '20200718', '20200717', '20200716', '20200715', '20200714', '20200713', '20200712', '20200711', '20200710', '20200709', '20200708', '20200707', '20200706', '20200705', '20200704', '20200703', '20200702', '20200701', '20200630', '20200629', '20200628', '20200627', '20200626', '20200625', '20200624', '20200623', '20200622', '20200621', '20200620', '20200619', '20200618', '20200617', '20200616', '20200615', '20200614', '20200613', '20200612', '20200611', '20200610', '20200609', '20200608', '20200607', '20200606', '20200605', '20200604', '20200603', '20200602', '20200601', '20200531', '20200530', '20200529', '20200528', '20200527', '20200526', '20200525', '20200524', '20200523', '20200522', '20200521', '20200520', '20200519', '20200518', '20200517', '20200516', '20200515', '20200514', '20200513', '20200512', '20200511', '20200510', '20200509', '20200508', '20200507', '20200506', '20200505', '20200504', '20200503', '20200502', '20200501', '20200430', '20200429', '20200428', '20200427', '20200426', '20200425', '20200424', '20200423', '20200422', '20200421', '20200420', '20200419', '20200418', '20200417', '20200416', '20200415', '20200414', '20200413', '20200412', '20200411', '20200410', '20200409', '20200408', '20200407', '20200406', '20200405', '20200404', '20200403', '20200402', '20200401', '20200331', '20200330', '20200329', '20200328', '20200327', '20200326', '20200325', '20200324', '20200323', '20200322', '20200321', '20200320', '20200319', '20200318', '20200317', '20200316', '20200315', '20200314', '20200313', '20200312', '20200311', '20200310', '20200309', '20200308', '20200307', '20200306', '20200305', '20200304', '20200303', '20200302', '20200301', '20200229', '20200228', '20200227', '20200226', '20200225', '20200224', '20200223', '20200222', '20200221', '20200220', '20200219', '20200218', '20200217', '20200216', '20200215', '20200214', '20200213', '20200212', '20200211', '20200210', '20200209', '20200208', '20200207', '20200206', '20200205', '20200204', '20200203', '20200202', '20200201', '20200131', '20200130', '20200129', '20200128', '20200127', '20200126', '20200125', '20200124', '20200123', '20200122', '20200121', '20200120', '20200119', '20200118', '20200117', '20200116', '20200115', '20200114', '20200113', '20200112', '20200111', '20200110', '20200109', '20200108', '20200107', '20200106', '20200105', '20200104', '20200103', '20200102', '20200101', '20191231', '20191230', '20191229', '20191228', '20191227', '20191226', '20191225', '20191224', '20191223', '20191222', '20191221', '20191220', '20191219', '20191218', '20191217', '20191216', '20191215', '20191214', '20191213', '20191212', '20191211', '20191210', '20191209', '20191208', '20191207', '20191206', '20191205', '20191204', '20191203', '20191202', '20191201', '20191130', '20191129', '20191128', '20191127', '20191126', '20191125', '20191124', '20191123', '20191122', '20191121', '20191120', '20191119', '20191118', '20191117', '20191116', '20191115', '20191114', '20191113', '20191112', '20191111', '20191110', '20191109', '20191108', '20191107', '20191106', '20191105', '20191104', '20191103', '20191102', '20191101', '20191031', '20191030', '20191029', '20191028', '20191027', '20191026', '20191025', '20191024', '20191023', '20191022', '20191021', '20191020', '20191019', '20191018', '20191017', '20191016', '20191015', '20191014', '20191013', '20191012', '20191011', '20191010', '20191009', '20191008', '20191007', '20191006', '20191005', '20191004', '20191003', '20191002', '20191001', '20190930', '20190929', '20190928', '20190927', '20190926', '20190925', '20190924', '20190923', '20190922', '20190921', '20190920', '20190919', '20190918', '20190917', '20190916', '20190915', '20190914', '20190913', '20190912', '20190911', '20190910', '20190909', '20190908', '20190907', '20190906', '20190905', '20190904', '20190903', '20190902', '20190901', '20190831', '20190830', '20190829', '20190828', '20190827', '20190826', '20190825', '20190824', '20190823', '20190822', '20190821', '20190820', '20190819', '20190818', '20190817', '20190816', '20190815', '20190814', '20190813', '20190812', '20190811', '20190810', '20190809', '20190808', '20190807', '20190806', '20190805', '20190804', '20190803', '20190802', '20190801', '20190731', '20190730', '20190729', '20190728', '20190727', '20190726', '20190725', '20190724', '20190723', '20190722', '20190721', '20190720', '20190719', '20190718', '20190717', '20190716', '20190715', '20190714', '20190713', '20190712', '20190711', '20190710', '20190709', '20190708', '20190707', '20190706', '20190705', '20190704', '20190703', '20190702', '20190701', '20190630', '20190629', '20190628', '20190627', '20190626', '20190625', '20190624', '20190623', '20190622', '20190621', '20190620', '20190619', '20190618', '20190617', '20190616', '20190615', '20190614', '20190613', '20190612', '20190611', '20190610', '20190609', '20190608', '20190607', '20190606', '20190605', '20190604', '20190603', '20190602', '20190601', '20190531', '20190530', '20190529', '20190528', '20190527', '20190526', '20190525', '20190524', '20190523', '20190522', '20190521', '20190520', '20190519', '20190518', '20190517', '20190516', '20190515', '20190514', '20190513', '20190512', '20190511', '20190510', '20190509', '20190508', '20190507', '20190506', '20190505', '20190504', '20190503', '20190502', '20190501', '20190430', '20190429', '20190428', '20190427', '20190426', '20190425', '20190424', '20190423', '20190422', '20190421', '20190420', '20190419', '20190418', '20190417', '20190416', '20190415', '20190414', '20190413', '20190412', '20190411', '20190410', '20190409', '20190408', '20190407', '20190406', '20190405', '20190404', '20190403', '20190402', '20190401', '20190331', '20190330', '20190329', '20190328', '20190327', '20190326', '20190325', '20190324', '20190323', '20190322', '20190321', '20190320', '20190319', '20190318', '20190317', '20190316', '20190315', '20190314', '20190313', '20190312', '20190311', '20190310', '20190309', '20190308', '20190307', '20190306', '20190305', '20190304', '20190303', '20190302', '20190301', '20190228', '20190227', '20190226', '20190225', '20190224', '20190223', '20190222', '20190221', '20190220', '20190219', '20190218', '20190217', '20190216', '20190215', '20190214', '20190213', '20190212', '20190211', '20190210', '20190209', '20190208', '20190207', '20190206', '20190205', '20190204', '20190203', '20190202', '20190201', '20190131', '20190130', '20190129', '20190128', '20190127', '20190126', '20190125', '20190124', '20190123', '20190122', '20190121', '20190120', '20190119', '20190118', '20190117', '20190116', '20190115', '20190114', '20190113', '20190112', '20190111', '20190110', '20190109', '20190108', '20190107', '20190106', '20190105', '20190104', '20190103', '20190102', '20190101']

date_dict = {}
for i in url_list:
    key = i[:6]
    date_dict.setdefault(key, [])
    date_dict[key].append(i)

#months = ['202007', '202008', '202009', '202010', '202011',
          #'202012', '202101', '202102', '202103']   # 选择要爬取的月份,该月在url_list中存在

months =[ '201909','201908','201907',]
for i in months:
    urls = []
    month = date_dict[i]
    for j in month:
        url = "http://bf.win007.com/football/Over_" + j + ".htm"
        urls.append(url)
    # print(urls)
    isExists = os.path.exists('./data')
    if not isExists:
        os.makedirs('./data')
    csv_path = './data/{}.csv'.format(i)
    # print(csv_path)
    isExists = os.path.exists('./logs/{}'.format(i))
    if not isExists:
        os.makedirs('./logs/{}'.format(i))
    celue4.main(urls, csv_path, i)